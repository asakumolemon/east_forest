# 东林学社网站详细设计文档

# API 文档

## 基础路径

`/api/v1`

## 认证 (Auth)

### `POST /auth`

**描述**: 用户认证。

**请求体 (`AuthUserRequest`)**:
```json
{
  "username": "string",
  "password": "string"
}
```

**响应体 (`AuthUserResponse`)**:
```json
{
  "id": "string",
  "username": "string",
  "email": "string",
  "avatar_url": "string",
  "bio": "string",
  "token": "string"
}
```

## 用户 (User)

### `POST /users`

**描述**: 创建新用户。

**请求体 (`CreateUserRequest`)**:
```json
{
  "username": "string (可选)",
  "password": "string (可选)",
  "email": "string (可选)",
  "avatar_url": "string (可选)",
  "bio": "string (可选)"
}
```

**响应体 (`UserView`)**:
```json
{
  "id": "string",
  "username": "string",
  "email": "string",
  "avatar_url": "string",
  "bio": "string",
  "created_at": "DateTime<chrono::Utc>",
  "updated_at": "DateTime<chrono::Utc>"
}
```

### `GET /users`

**描述**: 获取所有用户或根据查询条件获取用户。

**查询参数 (`UserQuery`)**:
```json
{
  "id": "string (可选)",
  "username": "string (可选)",
  "email": "string (可选)"
}
```

**响应体 (`Vec<UserView>`)**:
```json
[
  {
    "id": "string",
    "username": "string",
    "email": "string",
    "avatar_url": "string",
    "bio": "string",
    "created_at": "DateTime<chrono::Utc>",
    "updated_at": "DateTime<chrono::Utc>"
  }
]
```

### `PUT /user`

**描述**: 更新用户信息。

**请求体 (`UpdateUserRequest`)**:
```json
{
  "id": "string",
  "username": "string (可选)",
  "password": "string (可选)",
  "email": "string (可选)",
  "avatar_url": "string (可选)",
  "bio": "string (可选)"
}
```

**响应体 (`UserView`)**:
```json
{
  "id": "string",
  "username": "string",
  "email": "string",
  "avatar_url": "string",
  "bio": "string",
  "created_at": "DateTime<chrono::Utc>",
  "updated_at": "DateTime<chrono::Utc>"
}
```

### `DELETE /user`

**描述**: 删除用户。

**请求体 (`DeleteUserRequest`)**:
```json
{
  "id": "string"
}
```

**响应**: `204 No Content` (成功删除)

### `GET /user`

**描述**: 获取单个用户。

**查询参数 (`UserQuery`)**:
```json
{
  "id": "string (可选)",
  "username": "string (可选)",
  "email": "string (可选)"
}
```

**响应体 (`UserView`)**:
```json
{
  "id": "string",
  "username": "string",
  "email": "string",
  "avatar_url": "string",
  "bio": "string",
  "created_at": "DateTime<chrono::Utc>",
  "updated_at": "DateTime<chrono::Utc>"
}
```

## 提示 (Prompt)

### `GET /prompts`

**描述**: 获取所有提示或根据查询条件获取提示。

**查询参数 (`PromptQuery`)**:
```json
{
  "id": "string (可选)",
  "title": "string (可选)",
  "category": "string (可选)",
  "content": "string (可选)",
  "difficulty_lecel": "integer (可选)"
}
```

**响应体 (`Vec<PromptView>`)**:
```json
[
  {
    "id": "string",
    "title": "string",
    "category": "string",
    "content": "string",
    "difficulty_lecel": "integer",
    "is_active": "boolean",
    "display_date": "DateTime<chrono::Utc>",
    "created_at": "DateTime<chrono::Utc>"
  }
]
```

### `POST /prompt`

**描述**: 创建新提示。

**请求体 (`CreatePromptRequest`)**:
```json
{
  "title": "string (可选)",
  "category": "string (可选)",
  "content": "string (可选)",
  "difficulty_level": "integer (可选)",
  "is_active": "boolean (可选)",
  "display_date": "DateTime<chrono::Utc> (可选)"
}
```

**响应体 (`PromptView`)**:
```json
{
  "id": "string",
  "title": "string",
  "category": "string",
  "content": "string",
  "difficulty_lecel": "integer",
  "is_active": "boolean",
  "display_date": "DateTime<chrono::Utc>",
  "created_at": "DateTime<chrono::Utc>"
}
```

### `PUT /prompt`

**描述**: 更新提示信息。

**请求体 (`UpdatePromptRequest`)**:
```json
{
  "id": "string",
  "title": "string (可选)",
  "category": "string (可选)",
  "content": "string (可选)",
  "difficulty_level": "integer (可选)",
  "is_active": "boolean (可选)",
  "display_date": "DateTime<chrono::Utc> (可选)"
}
```

**响应体 (`PromptView`)**:
```json
{
  "id": "string",
  "title": "string",
  "category": "string",
  "content": "string",
  "difficulty_lecel": "integer",
  "is_active": "boolean",
  "display_date": "DateTime<chrono::Utc>",
  "created_at": "DateTime<chrono::Utc>"
}
```

### `DELETE /prompt`

**描述**: 删除提示。

**请求体 (`DeletePromptRequest`)**:
```json
{
  "id": "string"
}
```

**响应**: `200 OK` (成功删除)

## 文章 (Article)

### `GET /articles/`

**描述**: 获取所有文章或根据查询条件获取文章。

**查询参数 (`ArticleQuery`)**:
```json
{
  "id": "string (可选)",
  "user_id": "string (可选)",
  "prompt_id": "string (可选)",
  "title": "string (可选)",
  "word_count": "integer (可选)",
  "is_public": "boolean (可选)",
  "content": "string (可选)",
  "ai_score": "float (可选)"
}
```

**响应体 (`Vec<ArticleView>`)**:
```json
[
  {
    "id": "string",
    "user_id": "string",
    "prompt_id": "string",
    "title": "string",
    "word_count": "integer",
    "is_public": "boolean",
    "content": "string",
    "ai_score": "float",
    "created_at": "DateTime<chrono::Utc>",
    "updated_at": "DateTime<chrono::Utc>"
  }
]
```

### `POST /article`

**描述**: 创建新文章。

**请求体 (`CreateArticleRequest`)**:
```json
{
  "user_id": "string",
  "prompt_id": "string",
  "title": "string",
  "word_count": "integer",
  "is_public": "boolean",
  "content": "string",
  "ai_score": "float"
}
```

**响应体 (`ArticleView`)**:
```json
{
  "id": "string",
  "user_id": "string",
  "prompt_id": "string",
  "title": "string",
  "word_count": "integer",
  "is_public": "boolean",
  "content": "string",
  "ai_score": "float",
  "created_at": "DateTime<chrono::Utc>",
  "updated_at": "DateTime<chrono::Utc>"
}
```

### `PUT /article`

**描述**: 更新文章信息。

**请求体 (`UpdateArticleRequest`)**:
```json
{
  "id": "string",
  "user_id": "string",
  "prompt_id": "string",
  "title": "string",
  "word_count": "integer",
  "is_public": "boolean",
  "content": "string",
  "ai_score": "float"
}
```

**响应体 (`ArticleView`)**:
```json
{
  "id": "string",
  "user_id": "string",
  "prompt_id": "string",
  "title": "string",
  "word_count": "integer",
  "is_public": "boolean",
  "content": "string",
  "ai_score": "float",
  "created_at": "DateTime<chrono::Utc>",
  "updated_at": "DateTime<chrono::Utc>"
}
```

### `DELETE /article`

**描述**: 删除文章。

**请求体 (`DeleteArticleRequest`)**:
```json
{
  "id": "string"
}
```

**响应**: `200 OK` (成功删除)

### `GET /article/{id}`

**描述**: 根据ID获取单篇文章。

**路径参数**: `id` (string)

**响应体 (`ArticleView`)**:
```json
{
  "id": "string",
  "user_id": "string",
  "prompt_id": "string",
  "title": "string",
  "word_count": "integer",
  "is_public": "boolean",
  "content": "string",
  "ai_score": "float",
  "created_at": "DateTime<chrono::Utc>",
  "updated_at": "DateTime<chrono::Utc>"
}
```

## 评论 (Comment)

### `GET /comments`

**描述**: 获取所有评论或根据查询条件获取评论。

**查询参数 (`CommentQuery`)**:
```json
{
  "article_id": "string (可选)",
  "user_id": "string (可选)",
  "content": "string (可选)"
}
```

**响应体 (`Vec<CommentView>`)**:
```json
[
  {
    "id": "string",
    "article_id": "string",
    "user_id": "string",
    "content": "string",
    "likes": "integer",
    "created_at": "DateTime<chrono::Utc>"
  }
]
```

### `POST /comment`

**描述**: 添加新评论。

**请求体 (`CreateCommentRequest`)**:
```json
{
  "article_id": "string",
  "user_id": "string",
  "content": "string"
}
```

**响应体 (`CommentView`)**:
```json
{
  "id": "string",
  "article_id": "string",
  "user_id": "string",
  "content": "string",
  "likes": "integer",
  "created_at": "DateTime<chrono::Utc>"
}
```

### `PUT /comment`

**描述**: 更新评论。

**请求体 (`UpdateCommentRequest`)**:
```json
{
  "id": "string",
  "article_id": "string (可选)",
  "user_id": "string (可选)",
  "content": "string (可选)"
}
```

**响应体 (`CommentView`)**:
```json
{
  "id": "string",
  "article_id": "string",
  "user_id": "string",
  "content": "string",
  "likes": "integer",
  "created_at": "DateTime<chrono::Utc>"
}
```

### `DELETE /comment`

**描述**: 删除评论。

**请求体 (`DeleteCommentRequest`)**:
```json
{
  "id": "string"
}
```

**响应**: `200 OK` (成功删除)

## 用户交互 (User Interaction)

### `POST /user_interaction`

**描述**: 创建用户交互记录。

**请求体 (`CreateUserInteractionRequest`)**:

```json
{
  "user_id": "string",
  "prompt_id": "string",
  "article_id": "string",
  "comment_id": "string",
  "interaction_type": "string"
}
```

**响应体 (`UserInteractionView`)**:
```json
{
  "id": "string",
  "user_id": "string",
  "prompt_id": "string",
  "article_id": "string",
  "comment_id": "string",
  "interaction_type": "string",
  "created_at": "DateTime<chrono::Utc>"
}
```

### `GET /user_interaction`

**描述**: 获取用户交互记录。

**查询参数 (`UserInteractionQuery`)**:
```json
{
  "user_id": "string (可选)",
  "prompt_id": "string (可选)",
  "article_id": "string (可选)",
  "comment_id": "string (可选)",
  "interaction_type": "string (可选)"
}
```

**响应体 (`UserInteractionView`)**:
```json
{
  "id": "string",
  "user_id": "string",
  "prompt_id": "string",
  "article_id": "string",
  "comment_id": "string",
  "interaction_type": "string",
  "created_at": "DateTime<chrono::Utc>"
}
```

### `DELETE /user_interaction`

**描述**: 删除用户交互记录。

**请求体 (`DeleteUserInteractionRequest`)**:
```json
{
  "id": "string"
}
```

**响应**: `200 OK` (成功删除)

希望这份文档能帮助您对接前端！如果您需要更详细的信息或有其他问题，请随时告诉我。
        